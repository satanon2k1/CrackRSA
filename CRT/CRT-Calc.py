'''
Have e, n and dp (mean d mod p-1, d is private key). Proof:
- We have d = (1/e) mod (p-1)(q-1) and dp = d mod p-1
==> dp = ((1/e) mod (p-1)(q-1)) mod p-1
<=> dp = (1/e) mod p-1
<=> e * dp = 1 mod p-1
<=> e * dp - 1 = k * (p-1)
<=> p = (e * dp - 1 + k) / k
'''

def get_prime(n,e,dp):
	for k in range(2,e):
		p = (e * dp - 1 + k) // k
		if n % p == 0:
			return p, n // p
	return -1

e = 65537
n = 27868578779248323295726592006084932856773908840861649178318343151755887398382604564810576774670688704515367647560317930192308982669878182924112727125912603671520836916591305675503571448816333331358724817236275231395266995456684707287113519303312129253653017823735912654751369680851876478831487720692132625497208750041569737823045594323700009915019372031374546046248345473368817970059235947444710270475329406813027065189127980663089358095097950625428853696742735288765623208413274313175673596088617095602178061616000297804584908428929450888125993185758071895876612269751466593787033668866607516221365914504313575182791
dp = 76403693741441365621384231595508296879082080408168863915123111431367634801801797197233740723121970829731133757762956745513110924225385794161218709533707139541379241389204379617009225435952006068612002297106600939390046134580470980292348866901595523734576395006619790034238054152773475974558804218633708310017

p, q = get_prime(n, e, dp)
print(p, q)
